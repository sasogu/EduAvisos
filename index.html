<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>EduAvisos</title>

    <!-- Anti-cachÃ© (Ãºtil en desarrollo con http.server / recargas) -->
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <script>
      // Cache-busting automÃ¡tico: fuerza recarga de CSS/JS en cada carga.
      (function () {
        const v = Date.now().toString();
        window.__EDUNOTAS_V = v;

        const link = document.createElement("link");
        link.rel = "stylesheet";
        link.href = `styles.css?v=${v}`;
        document.head.appendChild(link);
      })();
    </script>
  </head>
  <body>
    <header class="header">
      <div class="container header__row">
        <h1 class="title">EduAvisos</h1>
        <div class="controls">
          <label class="field">
            <span class="field__label">Clase</span>
            <select id="classSelect" class="field__input" aria-label="Seleccionar clase"></select>
          </label>

          <label class="field">
            <span class="field__label">Nombre de clase</span>
            <input id="className" class="field__input" type="text" placeholder="Ej: 1ÂºA" />
          </label>
          <button id="saveClassNameBtn" class="btn" type="button">Guardar nombre</button>

          <button id="resetClassBtn" class="btn btn--secondary" type="button">Reiniciar contadores</button>
        </div>
      </div>
    </header>

    <main class="container">
      <section class="panel" aria-labelledby="importTitle">
        <div class="panel__header">
          <h2 id="importTitle" class="panel__title">Importar alumnos</h2>
          <p class="panel__subtitle">ImportaciÃ³n local: aÃ±ade alumnos nuevos a la clase actual (si el nombre ya existe, se queda como estÃ¡).</p>
          <div class="panel__actions">
            <button id="openImportBtn" class="btn" type="button">Abrir importador</button>
          </div>
        </div>
      </section>

      <dialog id="importDialog" class="modal" aria-labelledby="importDialogTitle">
        <div class="modal__header">
          <h3 id="importDialogTitle" class="modal__title">Importar alumnos (local)</h3>
          <button id="closeImportBtn" class="btn btn--secondary" type="button">Cerrar</button>
        </div>

        <p class="modal__subtitle">Pega una lista (1 alumno por lÃ­nea) o carga un archivo .txt/.csv. Se AÃ‘ADEN a la clase actual (no se borra lo existente).</p>

        <div class="import">
          <label class="field field--grow">
            <span class="field__label">Pegar lista</span>
            <textarea id="importTextarea" class="field__input field__textarea" rows="8" placeholder="Ejemplo:
Ana PÃ©rez
Juan LÃ³pez
MarÃ­a GarcÃ­a"></textarea>
          </label>

          <div class="import__actions">
            <label class="field">
              <span class="field__label">Archivo</span>
              <input id="importFile" class="field__input" type="file" accept=".txt,.csv,text/plain,text/csv" />
            </label>

            <button id="importApplyBtn" class="btn" type="button">Importar en esta clase</button>
            <button id="importClearBtn" class="btn btn--secondary" type="button">Limpiar caja</button>
          </div>
        </div>
      </dialog>

      <section class="panel" aria-labelledby="listTitle">
        <div class="panel__header">
          <div class="panel__headerRow">
            <h2 id="listTitle" class="panel__title">Alumnos</h2>
            <div class="listControls">
              <label class="field field--inline">
                <span class="field__label">â˜¹ï¸Ž â‰¥</span>
                <input id="minCount" class="field__input field__input--small" type="number" min="0" step="1" value="0" />
              </label>
              <label class="field field--inline">
                <span class="field__label">ðŸ™‚ â‰¥</span>
                <input id="minPositive" class="field__input field__input--small" type="number" min="0" step="1" value="0" />
              </label>
              <button id="clearFilterBtn" class="btn btn--secondary" type="button">Limpiar filtro</button>
              <div class="status" id="status"></div>
            </div>
          </div>
          <p class="panel__subtitle">Click en el nombre: +1 â˜¹ï¸Ž. Botones "+â˜¹ï¸Ž" y "+ðŸ™‚" para sumar sin pinchar el nombre.</p>
        </div>

        <div id="emptyState" class="empty" hidden>
          AÃºn no hay alumnos en esta clase. Importa una lista arriba.
        </div>

        <ul id="studentList" class="list" aria-label="Lista de alumnos"></ul>
      </section>
    </main>

    <footer class="footer">
      <div class="container footer__row">
        <span class="muted">Datos guardados en tu navegador (localStorage).</span>
      </div>
    </footer>

    <script>
      (function () {
        const v = window.__EDUNOTAS_V || Date.now().toString();
        const s = document.createElement("script");
        s.src = `app.js?v=${v}`;
        document.body.appendChild(s);
      })();
    </script>
  </body>
</html>
